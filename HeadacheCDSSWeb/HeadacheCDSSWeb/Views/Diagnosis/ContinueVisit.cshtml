@{
    ViewBag.Title = "ContinueVisit";
    Layout = "~/Views/Shared/Diagnosis_Layout.cshtml";
}
<p id="ocx">
    <object id="Reporter2" classid="clsid:466F909A-0EE1-4F40-A2CA-9906C5E36CB2" width="920"
        height="540">
    </object>
</p>
<script type="text/javascript">
$(function () {
        var obj = eval ("(" + @Html.Raw(Json.Encode(ViewData["data"]))+ ")");
        var OCX = document.getElementById('Reporter2');
        //set the data to OCX
        //set patient information
        if(null != obj.Name)
            OCX.SetObjectInfo("TextBox_2", "text", obj.Name);
        if(null != obj.Sex)
            OCX.SetObjectInfo("TextBox_3", "text", obj.Sex);
        if(null != obj.ChiefDoctor)
            OCX.SetObjectInfo("TextBox_4", "text", obj.ChiefDoctor);
        if(null != obj.Phone)
            OCX.SetObjectInfo("TextBox_6", "text", obj.Phone);
        if(null != obj.Address)
            OCX.SetObjectInfo("TextBox_8", "text", obj.Address);
        var strChiefComplaint = "";

        //set Secondary Headache Symptom
        var strSecondaryHeadacheSymptom = "";
        var lSymptomCount = obj.secondaryheadachesymptom.length;
        //set chief complaint
        if(0 != lSymptomCount)
            strChiefComplaint = "继发性头痛:";
        for(var lSymptomIndex = 0; lSymptomIndex < lSymptomCount; ++lSymptomIndex)
        {
            strSecondaryHeadacheSymptom = obj.secondaryheadachesymptom[lSymptomIndex];

            //set chief complaint
            strChiefComplaint += " ";
            strChiefComplaint += strSecondaryHeadacheSymptom;

            if("突然发生的头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_1", "checked", "true");
            else if("逐渐加重的头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_2", "checked", "true");
            else if("伴有系统性病变征象（发热、颈强直、皮疹）的头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_3", "checked", "true");
            else if("神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_4", "checked", "true");
            else if("伴有认知障碍的头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_5", "checked", "true");
            else if("视乳头水肿" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_6", "checked", "true");
            else if("由咳嗽、用力动作诱发的头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_8", "checked", "true");
            else if("妊娠期或产后头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_9", "checked", "true");
            else if("癌症患者或AIDS患者出现新发头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_10", "checked", "true");
            else if("50岁后的新发头痛" == strSecondaryHeadacheSymptom)
                OCX.SetObjectInfo("CheckBox_7", "checked", "true");
        }

        //set the headache overview
        var strOnsetDate = obj.headacheoverview.OnsetDate;
        strChiefComplaint += "最近起病年月：" + strOnsetDate;
        var strFirstOnsetContinue = obj.headacheoverview.FirstOnsetContinue;
        strChiefComplaint += " " + "首次发作即每天头痛：" + strFirstOnsetContinue;
        var strOnsetFixedDay = obj.headacheoverview.OnsetFixedDay;
        strChiefComplaint += " " + "每天固定的时间：" + strOnsetFixedDay;
        var strOnsetFixedYear = obj.headacheoverview.OnsetFixedYear;
        strChiefComplaint += " " + "每年的固定时间：" + strOnsetFixedYear;
        var strHeadacheDegree = obj.headacheoverview.HeadacheDegree;
        strChiefComplaint += " " + "头痛程度评分：" + strHeadacheDegree;
        var strHeadacheType = obj.headacheoverview.HeadacheType;
        strChiefComplaint += " " + "日常生活是否加重头痛：" + strHeadacheType;
        var strDailyAggravation = obj.headacheoverview.DailyAggravation;
        strChiefComplaint += " " + "头痛疼痛性质：" + strDailyAggravation;
        var strHeadcheTime = obj.headacheoverview.HeadcheTime;
        strChiefComplaint += " " + "每次头痛持续时间：" + strHeadcheTime;
        var strHeacheTimeUnit = obj.headacheoverview.HeacheTimeUnit;
        strChiefComplaint += strHeacheTimeUnit;
        var strOnsetAmount = obj.headacheoverview.OnsetAmount;
        strChiefComplaint += " " + "头痛发作次数：" + strOnsetAmount;
        var strFrequencyPerMonth = obj.headacheoverview.FrequencyPerMonth;
        strChiefComplaint += " " + "最近三个月平均头痛频率：" + strFrequencyPerMonth + "天/每月";
        var strFrequencyPerDay = obj.headacheoverview.FrequencyPerDay;
        strChiefComplaint += " " + strFrequencyPerDay + "次/每天";

        OCX.SetObjectInfo("DateTime_1", "text", strOnsetDate);
        OCX.SetObjectInfo("ComboBox_5", "text", strFirstOnsetContinue);
        OCX.SetObjectInfo("ComboBox_1", "text", strOnsetFixedDay);
        OCX.SetObjectInfo("ComboBox_6", "text", strOnsetFixedYear);
        OCX.SetObjectInfo("ComboBox_2", "text", strHeadacheDegree);
        OCX.SetObjectInfo("ComboBox_3", "text", strHeadacheType);
        OCX.SetObjectInfo("ComboBox_8", "text", strDailyAggravation);
        OCX.SetObjectInfo("TextBox_1", "text", strHeadcheTime);
        OCX.SetObjectInfo("ComboBox_4", "text", strHeacheTimeUnit);
        if(strOnsetAmount == "类似发作<5次")
            OCX.SetObjectInfo("RadioBox_8", "checked", "true");
        if(strOnsetAmount == "类似发作6-9次")
            OCX.SetObjectInfo("RadioBox_6", "checked", "true");
        if(strOnsetAmount == "类似发作超过10次")
            OCX.SetObjectInfo("RadioBox_7", "checked", "true");
        if(strOnsetAmount == "持续头痛")
            OCX.SetObjectInfo("RadioBox_5", "checked", "true");
        OCX.SetObjectInfo("ComboBox_9", "text", strFrequencyPerMonth);
        OCX.SetObjectInfo("ComboBox_10", "text", strFrequencyPerDay);

        //set headache place
        var strHeadachePlace = "";
        var lheadacheplaceCount = obj.headacheplace.length;
        for(var lheadacheplaceIndex = 0; lheadacheplaceIndex < lheadacheplaceCount; ++lheadacheplaceIndex)
        {
            strHeadachePlace = obj.headacheplace[lheadacheplaceIndex];
            if(strHeadachePlace.indexOf("左")>=0)
                strHeadachePlace = "左侧为主";
            else if(strHeadachePlace.indexOf("右")>=0)
                strHeadachePlace = "右侧为主";
            else if(strHeadachePlace.indexOf("双")>=0)
                strHeadachePlace = "双侧";
            if("" != strHeadachePlace)
                break;
        }
        var strSpecificPlace1 = "";
        var strSpecificPlace2 = "";
        var strSpecificPlace3 = "";
        var strSpecificPlace4 = "";
        var strSpecificPlace5 = "";
        var strSpecificPlace6 = "";
        var strSpecificPlace7 = "";
        var strSpecificPlace8 = "";
        var strSpecificPlace9 = "";
        var strSpecificPlace10 = "";
        var strSpecificPlace11 = "";
        var strSpecificPlace12 = "";
        var strSpecificPlace13 = "";

        //set Chief Complaint
        strChiefComplaint += " " + "头痛部位：";

        for(var lheadacheplaceIndex = 0; lheadacheplaceIndex < lheadacheplaceCount; ++lheadacheplaceIndex)
        {
            //set Chief Complaint
            strChiefComplaint += " " + obj.headacheplace[lheadacheplaceIndex];

            if(obj.headacheplace[lheadacheplaceIndex].indexOf("颞部")>=0)
                strSpecificPlace1 = "颞部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("枕部")>=0)
                strSpecificPlace2 = "枕部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("顶部")>=0)
                strSpecificPlace3 = "顶部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("眶部")>=0)
                strSpecificPlace4 = "眶部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("颈部")>=0)
                strSpecificPlace5 = "颈部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("颌部")>=0)
                strSpecificPlace6 = "颌部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("牙部")>=0)
                strSpecificPlace7 = "牙部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("脸部")>=0)
                strSpecificPlace8 = "脸部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("耳部")>=0)
                strSpecificPlace9 = "耳部";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("眼睑")>=0)
                strSpecificPlace10 = "眼睑";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("前额")>=0)
                strSpecificPlace11 = "前额";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("全头痛")>=0)
                strSpecificPlace12 = "全头痛";
            else if(obj.headacheplace[lheadacheplaceIndex].indexOf("其他")>=0)
                strSpecificPlace13 = "其他";
        }

        if(strHeadachePlace == "左侧为主")
        {
            if(strSpecificPlace1 == "颞部")
                OCX.SetObjectInfo("CheckBox_40", "checked", "true");
            if(strSpecificPlace2 == "枕部")
                OCX.SetObjectInfo("CheckBox_39", "checked", "true");
            if(strSpecificPlace3 == "顶部")
                OCX.SetObjectInfo("CheckBox_35", "checked", "true");
            if(strSpecificPlace4 == "眶部")
                OCX.SetObjectInfo("CheckBox_32", "checked", "true");
            if(strSpecificPlace5 == "颈部")
                OCX.SetObjectInfo("CheckBox_22", "checked", "true");
            if(strSpecificPlace6 == "颌部")
                OCX.SetObjectInfo("CheckBox_38", "checked", "true");
            if(strSpecificPlace7 == "牙部")
                OCX.SetObjectInfo("CheckBox_37", "checked", "true");
            if(strSpecificPlace8 == "脸部")
                OCX.SetObjectInfo("CheckBox_36", "checked", "true");
            if(strSpecificPlace9 == "耳部")
                OCX.SetObjectInfo("CheckBox_33", "checked", "true");
            if(strSpecificPlace10 == "眼睑")
                OCX.SetObjectInfo("CheckBox_31", "checked", "true");
            if(strSpecificPlace11 == "前额")
                OCX.SetObjectInfo("CheckBox_34", "checked", "true");
        }
        else if(strHeadachePlace == "右侧为主")
        {
            if(strSpecificPlace1 == "颞部")
                OCX.SetObjectInfo("CheckBox_51", "checked", "true");
            if(strSpecificPlace2 == "枕部")
                OCX.SetObjectInfo("CheckBox_49", "checked", "true");
            if(strSpecificPlace3 == "顶部")
                OCX.SetObjectInfo("CheckBox_47", "checked", "true");
            if(strSpecificPlace4 == "眶部")
                OCX.SetObjectInfo("CheckBox_43", "checked", "true");
            if(strSpecificPlace5 == "颈部")
                OCX.SetObjectInfo("CheckBox_41", "checked", "true");
            if(strSpecificPlace6 == "颌部")
                OCX.SetObjectInfo("CheckBox_50", "checked", "true");
            if(strSpecificPlace7 == "牙部")
                OCX.SetObjectInfo("CheckBox_48", "checked", "true");
            if(strSpecificPlace8 == "脸部")
                OCX.SetObjectInfo("CheckBox_46", "checked", "true");
            if(strSpecificPlace9 == "耳部")
                OCX.SetObjectInfo("CheckBox_44", "checked", "true");
            if(strSpecificPlace10 == "眼睑")
                OCX.SetObjectInfo("CheckBox_42", "checked", "true");
            if(strSpecificPlace11 == "前额")
                OCX.SetObjectInfo("CheckBox_45", "checked", "true");
        }
        else if(strHeadachePlace == "双侧")
        {
            if(strSpecificPlace1 == "颞部")
                OCX.SetObjectInfo("CheckBox_53", "checked", "true");
            if(strSpecificPlace2 == "枕部")
                OCX.SetObjectInfo("CheckBox_54", "checked", "true");
            if(strSpecificPlace3 == "顶部")
                OCX.SetObjectInfo("CheckBox_57", "checked", "true");
            if(strSpecificPlace4 == "眶部")
                OCX.SetObjectInfo("CheckBox_61", "checked", "true");
            if(strSpecificPlace5 == "颈部")
                OCX.SetObjectInfo("CheckBox_62", "checked", "true");
            if(strSpecificPlace6 == "颌部")
                OCX.SetObjectInfo("CheckBox_52", "checked", "true");
            if(strSpecificPlace7 == "牙部")
                OCX.SetObjectInfo("CheckBox_55", "checked", "true");
            if(strSpecificPlace8 == "脸部")
                OCX.SetObjectInfo("CheckBox_56", "checked", "true");
            if(strSpecificPlace9 == "耳部")
                OCX.SetObjectInfo("CheckBox_59", "checked", "true");
            if(strSpecificPlace10 == "眼睑")
                OCX.SetObjectInfo("CheckBox_60", "checked", "true");
            if(strSpecificPlace11 == "前额")
                OCX.SetObjectInfo("CheckBox_58", "checked", "true");
        }
        if("全头痛" == strSpecificPlace12)
            OCX.SetObjectInfo("CheckBox_QuanHeadache", "checked", "true");
        if("其他" == strSpecificPlace13)
            OCX.SetObjectInfo("CheckBox_OtherHeadache", "checked", "true");

        //set HeadacheAccompany
        var strHeadacheAccompany = "";
        var lHeadacheAccompanyCount = obj.headacheaccompany.length;

        //set Chief Complaint
        strChiefComplaint += " " + "头痛伴随症状:";

        for(var lHeadacheAccompanyIndex = 0; lHeadacheAccompanyIndex < lHeadacheAccompanyCount; ++lHeadacheAccompanyIndex)
        {
            strHeadacheAccompany = obj.headacheaccompany[lHeadacheAccompanyIndex];
            if("恶心" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Exin", "checked", "true");
            else if("呕吐" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Otu", "checked", "true");
            else if("畏光" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Weiguang", "checked", "true");
            else if("怕吵" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Pachao", "checked", "true");
            else if("同侧鼻塞/流涕" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongcebisai", "checked", "true");
            else if("同侧结膜充血/流泪" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongcejiemochongxue", "checked", "true");
            else if("同侧前额/面部出汗" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongceqianechuhan", "checked", "true");
            else if("同侧眼睑水肿" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongceyanjianshuizhong", "checked", "true");
            else if("同侧眼睑下垂" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongceyanjianxiachui", "checked", "true");
            else if("同侧瞳孔缩小" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Tongcetongkongsuoxiao", "checked", "true");
            else if("感觉不安或躁动" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_Ganjuebuan", "checked", "true");
            else if("其它" == strHeadacheAccompany)
                OCX.SetObjectInfo("CheckBox_OtherCompanySympton", "checked", "true");
        }

        //set HeadacheProdrome
        var strHeadacheProdrome = "";
        var lHeadacheProdromeCount = obj.headacheprodrome.length;

        //set Chief Complaint
        strChiefComplaint += " " + "头痛先兆:";

        for(var lHeadacheProdromeIndex = 0; lHeadacheProdromeIndex < lHeadacheProdromeCount; ++lHeadacheProdromeIndex)
        {
            strHeadacheProdrome = obj.headacheprodrome[lHeadacheProdromeIndex];

            //set Chief Complaint
            strChiefComplaint += " " + strHeadacheProdrome;

            if("视觉（点状/色斑/线型闪光幻觉/视野缺损）" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_VisionYes", "checked", "true");
            else if("感觉（针刺感/麻木）" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_FeelingYes", "checked", "true");
            else if("语言障碍" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_WordYes", "checked", "true");
            else if("运动障碍" == strHeadacheProdrome)
                OCX.SetObjectInfo("RadioBox_2", "checked", "true");         
        }

        //set PreviousExam
        var strExamName = "";
        var strResult = "";
        var strDate = "";
        var lPreviousExamCount = obj.previousexam.length;
        for(var lPreviousExamIndex = 0; lPreviousExamIndex < lPreviousExamCount; ++lPreviousExamIndex)
        {
            strExamName = obj.previousexam[lPreviousExamIndex].ExamName;
            strResult = obj.previousexam[lPreviousExamIndex].Result;
            strDate = obj.previousexam[lPreviousExamIndex].Date;
            if(0 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_InspectionItem1", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_InspectionItem1Normal", "checked", "true");
                OCX.SetObjectInfo("DateTime_InspectionItem1Date", "text", strDate);
            }
            else if(1 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_InspectionItem2", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_InspectionItem2Normal", "checked", "true");
                OCX.SetObjectInfo("DateTime_InspectionItem2Date", "text", strDate);
            }
            else if(2 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_InspectionItem3", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_InspectionItem3Normal", "checked", "true");
                OCX.SetObjectInfo("DateTime_InspectionItem3Date", "text", strDate);
            }
            else if(3 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_InspectionItem4", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_InspectionItem4Normal", "checked", "true");
                OCX.SetObjectInfo("DateTime_InspectionItem4Date", "text", strDate);
            }
            else if(4 == lPreviousExamIndex)
            {
                OCX.SetObjectInfo("ComboBox_InspectionItem5", "text", strExamName);
                if("正常" == strResult)
                    OCX.SetObjectInfo("RadioBox_InspectionItem5Normal", "checked", "true");
                OCX.SetObjectInfo("DateTime_InspectionItem5Date", "text", strDate);
            }
        }

        //set PreviousDrug
        var strDrugCategory = "";
        var strDrugName = "";
        var strDayAmoutnPerM = "";
        var strMonthTotalAmount = "";
        var lPreviousDrugCount = obj.previousdrug.length;
        for(var lPreviousDrugIndex = 0; lPreviousDrugIndex < lPreviousDrugCount; ++lPreviousDrugIndex)
        {
            strDrugCategory = obj.previousdrug[lPreviousDrugIndex].DrugCategory;
            strDrugName = obj.previousdrug[lPreviousDrugIndex].DrugName;
            strDayAmoutnPerM = obj.previousdrug[lPreviousDrugIndex].DayAmoutnPerM;
            strMonthTotalAmount = obj.previousdrug[lPreviousDrugIndex].MonthTotalAmount;
            if(0 == lPreviousDrugIndex)
            {
                OCX.SetObjectInfo("ComboBox_DrugCatogry1", "text", strDrugCategory);
                OCX.SetObjectInfo("TextBox_20", "text", strDrugName);
                OCX.SetObjectInfo("TextBox_Takemedicinedays1", "text", strDayAmoutnPerM);
                OCX.SetObjectInfo("TextBox_Takemedicinemonths1", "text", strMonthTotalAmount);
            }
            else if(1 == lPreviousDrugIndex)
            {
                OCX.SetObjectInfo("ComboBox_DrugCatogry2", "text", strDrugCategory);
                OCX.SetObjectInfo("TextBox_19", "text", strDrugName);
                OCX.SetObjectInfo("TextBox_Takemedicinedays2", "text", strDayAmoutnPerM);
                OCX.SetObjectInfo("TextBox_Takemedicinemonths2", "text", strMonthTotalAmount);
            }
            else if(2 == lPreviousDrugIndex)
            {
                OCX.SetObjectInfo("ComboBox_DrugCatogry3", "text", strDrugCategory);
                OCX.SetObjectInfo("TextBox_18", "text", strDrugName);
                OCX.SetObjectInfo("TextBox_Takemedicinedays3", "text", strDayAmoutnPerM);
                OCX.SetObjectInfo("TextBox_Takemedicinemonths3", "text", strMonthTotalAmount);
            }
            else if(3 == lPreviousDrugIndex)
            {
                OCX.SetObjectInfo("ComboBox_DrugCatogry4", "text", strDrugCategory);
                OCX.SetObjectInfo("TextBox_17", "text", strDrugName);
                OCX.SetObjectInfo("TextBox_Takemedicinedays4", "text", strDayAmoutnPerM);
                OCX.SetObjectInfo("TextBox_Takemedicinemonths4", "text", strMonthTotalAmount);
            }
        }

        //set life style
        var strSmokeState = obj.patlifestyle.SmokeState;
        OCX.SetObjectInfo("ComboBox_IfSmoke", "text", strSmokeState);
        var strSmokeStartAge = obj.patlifestyle.SmokeStartAge;
        OCX.SetObjectInfo("TextBox_BeginAge", "text", strSmokeStartAge);
        var strSmokeQuitYear = obj.patlifestyle.SmokeQuitYear;
        OCX.SetObjectInfo("TextBox_QuitYears", "text", strSmokeQuitYear);
        var strSmokeYear = obj.patlifestyle.SmokeYear;
        OCX.SetObjectInfo("TextBox_SmokeYears", "text", strSmokeYear);
        var strCigarettesPerDay = obj.patlifestyle.CigarettesPerDay;
        OCX.SetObjectInfo("TextBox_CigaretteAmount", "text", strCigarettesPerDay);
        var strDrinkState = obj.patlifestyle.DrinkState;
        OCX.SetObjectInfo("ComboBox_IfDrink", "text", strDrinkState);
        var strDrinkStartAge = obj.patlifestyle.DrinkStartAge;
        OCX.SetObjectInfo("TextBox_7", "text", strDrinkStartAge);
        var strDrinkYear = obj.patlifestyle.DrinkYear;
        OCX.SetObjectInfo("TextBox_DrinkYears", "text", strDrinkYear);
        var strDrinkQuitYear = obj.patlifestyle.DrinkQuitYear;
        OCX.SetObjectInfo("TextBox_QuitDrinkYears", "text", strDrinkQuitYear);
        var strDrinkPerDay = obj.patlifestyle.DrinkPerDay;
        OCX.SetObjectInfo("TextBox_DrinkCapacityPerDay", "text", strDrinkPerDay);
        var strDrinkCategory = obj.patlifestyle.DrinkCategory;
        OCX.SetObjectInfo("ComboBox_DrinkKind", "text", strDrinkCategory);
        var strTeaPerDay = obj.patlifestyle.TeaPerDay;
        OCX.SetObjectInfo("TextBox_TeaCapacity", "text", strTeaPerDay);
        var strCoffePerDay = obj.patlifestyle.CoffePerDay;
        OCX.SetObjectInfo("TextBox_CoffeeCapacity", "text", strCoffePerDay);
        var strExercisePerWeek = obj.patlifestyle.ExercisePerWeek;
        OCX.SetObjectInfo("ComboBox_DoSportTimes", "text", strExercisePerWeek);
        var strExerciseTime = obj.patlifestyle.ExerciseTime;
        OCX.SetObjectInfo("ComboBox_DoSportTime", "text", strExerciseTime);
        var strExerciseDescription = obj.patlifestyle.ExerciseDescription;
        OCX.SetObjectInfo("TextBox_DoSportDescription", "text", strExerciseDescription);
        var strWeightChange = obj.patlifestyle.WeightChange;
        if("有" == strWeightChange)
            OCX.SetObjectInfo("RadioBox_WeightChange", "checked", "true");
        var strWeightChangeNote = obj.patlifestyle.WeightChangeNote;
        OCX.SetObjectInfo("ComboBox_7", "text", strWeightChangeNote);
        var listSpecialDiet = obj.patlifestyle.specialDiet;
        var strSpecialDiet = "";
        var lSpecialDietCount = obj.patlifestyle.specialDiet.length;
        for(var lSpecialDietIndex = 0; lSpecialDietIndex < lSpecialDietCount; ++lSpecialDietIndex)
        {
            strSpecialDiet = obj.patlifestyle.specialDiet[lSpecialDietIndex];
            if("低热量" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_LowHeat", "checked", "true");
            else if("低盐" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_LowSalt", "checked", "true");
            else if("低脂" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_LowFat", "checked", "true");
            else if("低纤维" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_LowFibre", "checked", "true");
            else if("低碳水化合物" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_LowCarbohydrate", "checked", "true");
            else if("高热量" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_HighHeat", "checked", "true");
            else if("高纤维" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_HighFibre", "checked", "true");
            else if("其他" == strSpecialDiet)
                OCX.SetObjectInfo("CheckBox_OtherDiet", "checked", "true");
        }

        //set Headache FamilyMember
        var strHeadacheFamilyMember = "";
        var lHeadacheFamilyMemberCount = obj.Hfamilymember.length;
        for(var lHeadacheFamilyMemberIndex = 0; lHeadacheFamilyMemberIndex < lHeadacheFamilyMemberCount; ++lHeadacheFamilyMemberIndex)
        {
            strHeadacheFamilyMember = obj.Hfamilymember[lHeadacheFamilyMemberIndex];
            if("父亲" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_21", "checked", "true");
            else if("母亲" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_18", "checked", "true");
            else if("兄弟" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_14", "checked", "true");
            else if("姐妹" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_12", "checked", "true");
            else if("儿子" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_20", "checked", "true");
            else if("女儿" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_17", "checked", "true");
            else if("祖父" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_13", "checked", "true");
            else if("祖母" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_63", "checked", "true");
            else if("外祖父" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_19", "checked", "true");
            else if("外祖母" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_16", "checked", "true");
            else if("其他" == strHeadacheFamilyMember)
                OCX.SetObjectInfo("CheckBox_15", "checked", "true");
        }

        //set similar headache
        var bSimilarFamily = obj.SimilarFamily;
        if(bSimilarFamily)
            OCX.SetObjectInfo("RadioBox_3", "checked", "true");

        //set Other family disease
        var strOfamilydisease = "";
        var lOfamilydiseaseCount = obj.Ofamilydisease.length;
        for(var lOfamilydiseaseIndex = 0; lOfamilydiseaseIndex < lOfamilydiseaseCount; ++lOfamilydiseaseIndex)
        {
            strOfamilydisease = obj.Ofamilydisease[lOfamilydiseaseIndex];
            if("心脏疾病" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_29", "checked", "true");
            else if("癫痫" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_27", "checked", "true");
            else if("高血压" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_25", "checked", "true");
            else if("卒中" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_23", "checked", "true");
            else if("关节炎" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_28", "checked", "true");
            else if("肿瘤" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_26", "checked", "true");
            else if("焦虑" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_24", "checked", "true");
            else if("其他" == strOfamilydisease)
                OCX.SetObjectInfo("CheckBox_30", "checked", "true");
        }

        //set Mitigating Factors
        var strMitigatingFactors = "";
        var lMitigatingFactorsCount = obj.mitigatingfactors.length;

        //set Chief Complaint
        strChiefComplaint += " " + "缓解因素:";

        for(var lMitigatingFactorsIndex = 0; lMitigatingFactorsIndex < lMitigatingFactorsCount; ++lMitigatingFactorsIndex)
        {
            strMitigatingFactors = obj.mitigatingfactors[lMitigatingFactorsIndex];

            //set Chief Complaint
            strChiefComplaint += " " + strMitigatingFactors;

            if("躺下" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_20", "text", "有");
            else if("黑暗/安静的房间" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_21", "text", "有");
            else if("按摩" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_22", "text", "有");
            else if("热敷" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_23", "text", "有");
            else if("冷敷" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_26", "text", "有");
            else if("快步走" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_11", "text", "有");
            else if("锻炼" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_12", "text", "有");
            else if("站立" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_13", "text", "有");
            else if("妊娠" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_17", "text", "有");
            else if("其他" == strMitigatingFactors)
                OCX.SetObjectInfo("ComboBox_18", "text", "有");
        }

        //set precipitating factors
        var strPrecipitatingFactorName = "";
        var strPrecipitatingFactorDetail = "";
        var lPrecipitatingFactorsCount = obj.precipitatingfactor.length;

        //set Chief Complaint
        strChiefComplaint += " " + "诱发因素:";

        for(var lPrecipitatingFactorsIndex = 0; lPrecipitatingFactorsIndex < lPrecipitatingFactorsCount; ++lPrecipitatingFactorsIndex)
        {
            strPrecipitatingFactorName = obj.precipitatingfactor[lPrecipitatingFactorsIndex].FName;
            strPrecipitatingFactorDetail = obj.precipitatingfactor[lPrecipitatingFactorsIndex].FDetail;

            //set Chief Complaint
            strChiefComplaint += " " + strPrecipitatingFactorName;
            strChiefComplaint += ":" + strPrecipitatingFactorDetail;

            if("睡眠" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_30", "text", strPrecipitatingFactorDetail);
            else if("感觉刺激" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_29", "text", strPrecipitatingFactorDetail);
            else if("紧张/情绪波动" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_28", "text", "有");
            else if("食物" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_27", "text", strPrecipitatingFactorDetail);
            else if("活动" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_25", "text", strPrecipitatingFactorDetail);
            else if("气候" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_14", "text", strPrecipitatingFactorDetail);
            else if("疲劳/放松" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_15", "text", strPrecipitatingFactorDetail);
            else if("激素变化" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_16", "text", strPrecipitatingFactorDetail);
            else if("体位" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_19", "text", strPrecipitatingFactorDetail);
            else if("其他" == strPrecipitatingFactorName)
                OCX.SetObjectInfo("ComboBox_24", "text", "有");
        }

        //set chief complaint
        OCX.SetObjectInfo("TextBox_9", "text", strChiefComplaint);
       
    $("#btn1").click(function () {
            $("#btn2").show();
            var OCX = document.getElementById('Reporter2');
            if($(".selected").last().attr("id") == "基本筛查"){
            //var Secondheadache=new Array()
                var myBoolean=new Boolean(false);
                for(var i =0;i<10;i++){
                          var j=i+1;
                          var Name="CheckBox_"+j.toString();
                          if("true" == OCX.GetObjectInfo(Name, "checked"))
                          {
                          myBoolean=true;
                          }
                  }
                 if(myBoolean==true){
                $(".selected").next().addClass("selected"); 
                $(".active").next().addClass("active");
                $(".active").first().removeClass("active");
               }
           
            }
            if ($(".selected").last().attr("id") == "辅助诊断")
            {
                //set chief complaint
                var strChiefComplaint = OCX.GetObjectInfo("TextBox_12", "text") + " 备注：" + OCX.GetObjectInfo("TextBox_13", "text");
                OCX.SetObjectInfo("TextBox_9", "text", strChiefComplaint);

                //set diagnose
                var strDiagnose = "";
                if("" != OCX.GetObjectInfo("ComboBox_31", "text"))
                    strDiagnose = OCX.GetObjectInfo("ComboBox_31", "text") + ":" + OCX.GetObjectInfo("ComboBox_32", "text") + "。  ";
                if("" != OCX.GetObjectInfo("ComboBox_33", "text"))
                    strDiagnose += OCX.GetObjectInfo("ComboBox_33", "text") + ":" + OCX.GetObjectInfo("ComboBox_34", "text") + "。  ";
                if("" != OCX.GetObjectInfo("ComboBox_36", "text"))
                    strDiagnose += OCX.GetObjectInfo("ComboBox_36", "text") + ":" + OCX.GetObjectInfo("ComboBox_35", "text") + "。";
                 OCX.SetObjectInfo("TextBox_10", "text", strDiagnose);
            }
            if ($(".selected").last().attr("id") == "基本筛查" || $(".selected").last().attr("id") == "头痛问诊")
            {
                var strChiefComplaint = "";

                //get SecondaryHeadacheSymptoms
                strChiefComplaint += "继发性头痛筛查:";
                if("true" == OCX.GetObjectInfo("CheckBox_1", "checked"))
                    strChiefComplaint += " " + "突然发生的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_2", "checked"))
                    strChiefComplaint += " " + "逐渐加重的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_3", "checked"))
                    strChiefComplaint += " " + "伴有系统性病变征象（发热、颈强直、皮疹）的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_4", "checked"))
                    strChiefComplaint += " " + "神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）";
                if("true" == OCX.GetObjectInfo("CheckBox_5", "checked"))
                    strChiefComplaint += " " + "伴有认知障碍的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_6", "checked"))
                   strChiefComplaint += " " + "视乳头水肿";
                if("true" == OCX.GetObjectInfo("CheckBox_7", "checked"))
                    strChiefComplaint += " " + "由咳嗽、用力动作诱发的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_8", "checked"))
                    strChiefComplaint += " " + "妊娠期或产后头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_9", "checked"))
                    strChiefComplaint += " " + "癌症患者或AIDS患者出现新发头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_10", "checked"))
                    strChiefComplaint += " " + "50岁后的新发头痛";

                if(strChiefComplaint == "继发性头痛筛查:")
                    strChiefComplaint = "";

                if("" == strChiefComplaint)
                {
                    //get the PrimaryHeadacheOverView information
                    var strOnsetDate = OCX.GetObjectInfo("DateTime_1", "text");
                    if ("/////" == strOnsetDate) 
                    {
                        strOnsetDate = "";
                    }
                    //var strOnsetDate = strOnsetDate.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                    var strFirstOnsetContinue = OCX.GetObjectInfo("ComboBox_5", "text");
                    var strOnsetFixedDay = OCX.GetObjectInfo("ComboBox_1", "text");
                    var strOnsetFixedYear = OCX.GetObjectInfo("ComboBox_6", "text");
                    var strHeadacheDegree = OCX.GetObjectInfo("ComboBox_2", "text");
                    var strHeadacheType = OCX.GetObjectInfo("ComboBox_3", "text");
                    var strDailyAggravation = OCX.GetObjectInfo("ComboBox_8", "text");
                    var strHeadcheTime = OCX.GetObjectInfo("TextBox_1", "text");
                    var strHeacheTimeUnit = OCX.GetObjectInfo("ComboBox_4", "text");
                    var strOnsetAmount = "";
                    if("true" == OCX.GetObjectInfo("RadioBox_8", "checked"))
                        strOnsetAmount = "类似发作<5次";
                    else if("true" == OCX.GetObjectInfo("RadioBox_6", "checked"))
                        strOnsetAmount = "类似发作6-9次";
                    else if("true" == OCX.GetObjectInfo("RadioBox_7", "checked"))
                        strOnsetAmount = "类似发作超过10次";
                    else if("true" == OCX.GetObjectInfo("RadioBox_5", "checked"))
                        strOnsetAmount = "持续头痛";
                    var strFrequencyPerMonth = OCX.GetObjectInfo("ComboBox_9", "text");
                    var strFrequencyPerDay = OCX.GetObjectInfo("ComboBox_10", "text");

                    //set the headache overview
                    strChiefComplaint += "最近起病年月：" + strOnsetDate;
                    strChiefComplaint += " " + "首次发作即每天头痛：" + strFirstOnsetContinue;
                    strChiefComplaint += " " + "每天固定的时间：" + strOnsetFixedDay;
                    strChiefComplaint += " " + "每年的固定时间：" + strOnsetFixedYear;
                    strChiefComplaint += " " + "头痛程度评分：" + strHeadacheDegree;
                    strChiefComplaint += " " + "日常生活是否加重头痛：" + strHeadacheType;
                    strChiefComplaint += " " + "头痛疼痛性质：" + strDailyAggravation;
                    strChiefComplaint += " " + "每次头痛持续时间：" + strHeadcheTime;
                    strChiefComplaint += strHeacheTimeUnit;
                    strChiefComplaint += " " + "头痛发作次数：" + strOnsetAmount;
                    strChiefComplaint += " " + "最近三个月平均头痛频率：" + strFrequencyPerMonth + "天/每月";
                    strChiefComplaint += " " + strFrequencyPerDay + "次/每天";

                    //get headache place
                    var strHeadachePlace = "";
                    var strSpecificPlace1 = "";
                    var strSpecificPlace2 = "";
                    var strSpecificPlace3 = "";
                    var strSpecificPlace4 = "";
                    var strSpecificPlace5 = "";
                    var strSpecificPlace6 = "";
                    var strSpecificPlace7 = "";
                    var strSpecificPlace8 = "";
                    var strSpecificPlace9 = "";
                    var strSpecificPlace10 = "";
                    var strSpecificPlace11 = "";
                    var strSpecificPlace12 = "";
                    var strSpecificPlace13 = "";

                    if("true" == OCX.GetObjectInfo("CheckBox_40", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace1 = "颞部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_39", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace2 = "枕部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_35", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace3 = "顶部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_32", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace4 = "眶部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_22", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace5 = "颈部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_38", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace6 = "颌部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_37", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace7 = "牙部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_36", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace8 = "脸部";
                    } 
                   if("true" == OCX.GetObjectInfo("CheckBox_33", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace9 = "耳部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_31", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace10 = "眼睑";
                    }    
                    if("true" == OCX.GetObjectInfo("CheckBox_34", "checked"))
                    {
                        strHeadachePlace = "左侧为主";
                        strSpecificPlace11 = "前额";
                    }

                    //right main
                    if("左侧为主" != strHeadachePlace)
                    {
                        if("true" == OCX.GetObjectInfo("CheckBox_51", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace1 = "颞部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_49", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace2 = "枕部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_47", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace3 = "顶部";
                        }
                       if("true" == OCX.GetObjectInfo("CheckBox_43", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace4 = "眶部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_41", "checked"))
                       {
                           strHeadachePlace = "右侧为主";
                           strSpecificPlace5 = "颈部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_50", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace6 = "颌部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_48", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace7 = "牙部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_46", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace8 = "脸部";
                        } 
                        if("true" == OCX.GetObjectInfo("CheckBox_44", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace9 = "耳部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_42", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace10 = "眼睑";
                        }    
                        if("true" == OCX.GetObjectInfo("CheckBox_45", "checked"))
                        {
                            strHeadachePlace = "右侧为主";
                            strSpecificPlace11 = "前额";
                        }
                    }

                    //both main
                    if("左侧为主" != strHeadachePlace && "右侧为主" != strHeadachePlace)
                    {
                        if("true" == OCX.GetObjectInfo("CheckBox_53", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace1 = "颞部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_54", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace2 = "枕部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_57", "checked"))
                        {
                            strHeadachePlace = "双侧";
                           strSpecificPlace3 = "顶部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_61", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace4 = "眶部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_62", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace5 = "颈部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_52", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace6 = "颌部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_55", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace7 = "牙部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_56", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace8 = "脸部";
                        } 
                        if("true" == OCX.GetObjectInfo("CheckBox_59", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace9 = "耳部";
                        }
                        if("true" == OCX.GetObjectInfo("CheckBox_60", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace10 = "眼睑";
                        }    
                        if("true" == OCX.GetObjectInfo("CheckBox_58", "checked"))
                        {
                            strHeadachePlace = "双侧";
                            strSpecificPlace11 = "前额";
                        }
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_QuanHeadache", "checked"))
                        strSpecificPlace12 = "全头痛";
                    if("true" == OCX.GetObjectInfo("CheckBox_OtherHeadache", "checked"))
                        strSpecificPlace13 = "其他";

                    strChiefComplaint += " " + "头痛部位：";
                    if("" != strSpecificPlace1)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace1;
                    if("" != strSpecificPlace2)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace2;
                    if("" != strSpecificPlace3)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace3;
                    if("" != strSpecificPlace4)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace4;
                    if("" != strSpecificPlace5)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace5;
                    if("" != strSpecificPlace6)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace6;
                    if("" != strSpecificPlace7)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace7;
                    if("" != strSpecificPlace8)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace8;
                    if("" != strSpecificPlace9)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace9;
                    if("" != strSpecificPlace10)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace10;
                    if("" != strSpecificPlace11)
                        strChiefComplaint += " " + strHeadachePlace + strSpecificPlace11;
                    if("" != strSpecificPlace12)
                        strChiefComplaint += " " + strSpecificPlace12;
                    if("" != strSpecificPlace13)
                        strChiefComplaint += " " + strSpecificPlace13;

                    //get headache accompany
                    //set Chief Complaint
                    strChiefComplaint += " " + "头痛伴随症状:";

                    if("true" == OCX.GetObjectInfo("CheckBox_Exin", "checked"))
                        strChiefComplaint += " " + "恶心";

                    if("true" == OCX.GetObjectInfo("CheckBox_Otu", "checked"))
                        strChiefComplaint += " " + "呕吐";

                    if("true" == OCX.GetObjectInfo("CheckBox_Weiguang", "checked"))
                        strChiefComplaint += " " + "畏光";

                    if("true" == OCX.GetObjectInfo("CheckBox_Pachao", "checked"))
                        strChiefComplaint += " " + "怕吵";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongcebisai", "checked"))
                        strChiefComplaint += " " + "同侧鼻塞/流涕";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongcejiemochongxue", "checked"))
                        strChiefComplaint += " " + "同侧结膜充血/流泪";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongceqianechuhan", "checked"))
                        strChiefComplaint += " " + "同侧前额/面部出汗";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongceyanjianshuizhong", "checked"))
                        strChiefComplaint += " " + "同侧眼睑水肿";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongceyanjianxiachui", "checked"))
                        strChiefComplaint += " " + "同侧眼睑下垂";

                    if("true" == OCX.GetObjectInfo("CheckBox_Tongcetongkongsuoxiao", "checked"))
                        strChiefComplaint += " " + "同侧瞳孔缩小";

                    if("true" == OCX.GetObjectInfo("CheckBox_Ganjuebuan", "checked"))
                        strChiefComplaint += " " + "感觉不安或躁动";

                    if("true" == OCX.GetObjectInfo("CheckBox_OtherCompanySympton", "checked"))
                        strChiefComplaint += " " + "其它";

                    //HeadacheProdrome
                    //set Chief Complaint
                    strChiefComplaint += " " + "头痛先兆:";
                    var strHeadacheProdrome1 = "";
                    var strHeadacheProdrome2 = "";
                    var strHeadacheProdrome3 = "";
                    var strHeadacheProdrome4 = "";
                    if("true" == OCX.GetObjectInfo("RadioBox_VisionYes", "checked"))
                        strChiefComplaint += " " + "视觉（点状/色斑/线型闪光幻觉/视野缺损）";
                    if("true" == OCX.GetObjectInfo("RadioBox_FeelingYes", "checked"))
                        strChiefComplaint += " " + "感觉（针刺感/麻木）";
                    if("true" == OCX.GetObjectInfo("RadioBox_WordYes", "checked"))
                        strChiefComplaint += " " + "语言障碍";
                    if("true" == OCX.GetObjectInfo("RadioBox_2", "checked"))
                        strChiefComplaint += " " + "运动障碍";

                    //get Mitigating information
                    //set Chief Complaint
                    strChiefComplaint += " " + "缓解因素:";
                    var strMitigatingFactor1 = "";
                    var strMitigatingFactor2 = "";
                    var strMitigatingFactor3 = "";
                    var strMitigatingFactor4 = "";
                    var strMitigatingFactor5 = "";
                    var strMitigatingFactor6 = "";
                    var strMitigatingFactor7 = "";
                    var strMitigatingFactor8 = "";
                    var strMitigatingFactor9 = "";
                    var strMitigatingFactor10 = "";
                    if("有" == OCX.GetObjectInfo("ComboBox_20", "text"))
                        strChiefComplaint += " " + "躺下";
                    if("有" == OCX.GetObjectInfo("ComboBox_21", "text"))
                        strChiefComplaint += " " + "黑暗/安静的房间";
                    if("有" == OCX.GetObjectInfo("ComboBox_22", "text"))
                        strChiefComplaint += " " + "按摩";
                    if("有" == OCX.GetObjectInfo("ComboBox_23", "text"))
                        strChiefComplaint += " " + "热敷";
                    if("有" == OCX.GetObjectInfo("ComboBox_26", "text"))
                        strChiefComplaint += " " + "冷敷";
                    if("有" == OCX.GetObjectInfo("ComboBox_11", "text"))
                        strChiefComplaint += " " + "快步走";
                    if("有" == OCX.GetObjectInfo("ComboBox_12", "text"))
                        strChiefComplaint += " " + "锻炼";
                    if("有" == OCX.GetObjectInfo("ComboBox_13", "text"))
                        strChiefComplaint += " " + "站立";
                    if("有" == OCX.GetObjectInfo("ComboBox_17", "text"))
                        strChiefComplaint += " " + "妊娠";
                    if("有" == OCX.GetObjectInfo("ComboBox_18", "text"))
                        strChiefComplaint += " " + "其他";

                    //get Precipitating Factor
                    //set Chief Complaint
                    strChiefComplaint += " " + "诱发因素:";
                    var strPrecipitatingFactor1 = "";
                    var strPrecipitatingFactor2 = "";
                    var strPrecipitatingFactor3 = "";
                    var strPrecipitatingFactor4 = "";
                    var strPrecipitatingFactor5 = "";
                    var strPrecipitatingFactor6 = "";
                    var strPrecipitatingFactor7 = "";
                    var strPrecipitatingFactor8 = "";
                    var strPrecipitatingFactor9 = "";
                    var strPrecipitatingFactor10 = "";
                    var strPrecipitatingFactorDetail1 = OCX.GetObjectInfo("ComboBox_30", "text");
                    var strPrecipitatingFactorDetail2 = OCX.GetObjectInfo("ComboBox_29", "text");
                    var strPrecipitatingFactorDetail3 = OCX.GetObjectInfo("ComboBox_28", "text");
                    var strPrecipitatingFactorDetail4 = OCX.GetObjectInfo("ComboBox_27", "text");
                    var strPrecipitatingFactorDetail5 = OCX.GetObjectInfo("ComboBox_25", "text");
                    var strPrecipitatingFactorDetail6 = OCX.GetObjectInfo("ComboBox_14", "text");
                    var strPrecipitatingFactorDetail7 = OCX.GetObjectInfo("ComboBox_15", "text");
                    var strPrecipitatingFactorDetail8 = OCX.GetObjectInfo("ComboBox_16", "text");
                    var strPrecipitatingFactorDetail9 = OCX.GetObjectInfo("ComboBox_19", "text");
                    var strPrecipitatingFactorDetail10 = OCX.GetObjectInfo("ComboBox_24", "text");
                    if("" != strPrecipitatingFactorDetail1)
                    {
                        strChiefComplaint += " " + "睡眠";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail1;
                    }
                    if("" != strPrecipitatingFactorDetail2)
                    {
                        strChiefComplaint += " " + "感觉刺激";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail2;
                    }
                    if("有" == strPrecipitatingFactorDetail3)
                    {
                        strChiefComplaint += " " + "紧张/情绪波动";
                    }
                    if("" != strPrecipitatingFactorDetail4)
                    {
                        strChiefComplaint += " " + "食物";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail4;
                    }
                    if("" != strPrecipitatingFactorDetail5)
                    {
                        strChiefComplaint += " " + "活动";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail5;
                    }
                    if("" != strPrecipitatingFactorDetail6)
                    {
                        strChiefComplaint += " " + "气候";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail6;
                    }
                    if("有" == strPrecipitatingFactorDetail7)
                    {
                        strChiefComplaint += " " + "疲劳/放松";
                    }
                    if("" != strPrecipitatingFactorDetail8)
                    {
                        strChiefComplaint += " " + "激素变化";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail8;
                    }
                    if("" != strPrecipitatingFactorDetail9)
                    {
                        strChiefComplaint += " " + "体位";
                        strChiefComplaint += ":" + strPrecipitatingFactorDetail9;
                    }
                    if("有" == strPrecipitatingFactorDetail10)
                    {
                        strChiefComplaint += " " + "其他";
                    }

                    OCX.SetObjectInfo("TextBox_12", "text", strChiefComplaint);
                }
         
           
                //get SecondaryHeadacheSymptoms
                var strSecondaryHeadacheSymptom1 = "";
                var strSecondaryHeadacheSymptom2 = "";
                var strSecondaryHeadacheSymptom3 = "";
                var strSecondaryHeadacheSymptom4 = "";
                var strSecondaryHeadacheSymptom5 = "";
                var strSecondaryHeadacheSymptom6 = "";
                var strSecondaryHeadacheSymptom7 = "";
                var strSecondaryHeadacheSymptom8 = "";
                var strSecondaryHeadacheSymptom9 = "";
                var strSecondaryHeadacheSymptom10 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_1", "checked"))
                    strSecondaryHeadacheSymptom1 = "突然发生的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_2", "checked"))
                    strSecondaryHeadacheSymptom2 = "逐渐加重的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_3", "checked"))
                    strSecondaryHeadacheSymptom3 = "伴有系统性病变征象（发热、颈强直、皮疹）的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_4", "checked"))
                    strSecondaryHeadacheSymptom4 = "神经系统局灶症状和体征（除典型的视觉、感觉先兆之外）";
                if("true" == OCX.GetObjectInfo("CheckBox_5", "checked"))
                    strSecondaryHeadacheSymptom5 = "伴有认知障碍的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_6", "checked"))
                   strSecondaryHeadacheSymptom6 = "视乳头水肿";
                if("true" == OCX.GetObjectInfo("CheckBox_7", "checked"))
                    strSecondaryHeadacheSymptom7 = "由咳嗽、用力动作诱发的头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_8", "checked"))
                    strSecondaryHeadacheSymptom8 = "妊娠期或产后头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_9", "checked"))
                    strSecondaryHeadacheSymptom9 = "癌症患者或AIDS患者出现新发头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_10", "checked"))
                    strSecondaryHeadacheSymptom10 = "50岁后的新发头痛";
                 
                
                //get the PrimaryHeadacheOverView information
                var strOnsetDate = OCX.GetObjectInfo("DateTime_1", "text");
                if ("/////" == strOnsetDate) 
                {
                    strOnsetDate = "1753/01/01///";
                }
                var strOnsetDate = strOnsetDate.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strFirstOnsetContinue = OCX.GetObjectInfo("ComboBox_5", "text");
                var strOnsetFixedDay = OCX.GetObjectInfo("ComboBox_1", "text");
                var strOnsetFixedYear = OCX.GetObjectInfo("ComboBox_6", "text");
                var strHeadacheDegree = OCX.GetObjectInfo("ComboBox_2", "text");
                var strHeadacheType = OCX.GetObjectInfo("ComboBox_3", "text");
                var strDailyAggravation = OCX.GetObjectInfo("ComboBox_8", "text");
                var strHeadcheTime = OCX.GetObjectInfo("TextBox_1", "text");
                var strHeacheTimeUnit = OCX.GetObjectInfo("ComboBox_4", "text");
                var strOnsetAmount = "";
                if("true" == OCX.GetObjectInfo("RadioBox_8", "checked"))
                    strOnsetAmount = "类似发作<5次";
                else if("true" == OCX.GetObjectInfo("RadioBox_6", "checked"))
                    strOnsetAmount = "类似发作6-9次";
                else if("true" == OCX.GetObjectInfo("RadioBox_7", "checked"))
                    strOnsetAmount = "类似发作超过10次";
                else if("true" == OCX.GetObjectInfo("RadioBox_5", "checked"))
                    strOnsetAmount = "持续头痛";
                var strFrequencyPerMonth = OCX.GetObjectInfo("ComboBox_9", "text");
                var strFrequencyPerDay = OCX.GetObjectInfo("ComboBox_10", "text");

                //get headache place
                var strHeadachePlace = "";
                var strSpecificPlace1 = "";
                var strSpecificPlace2 = "";
                var strSpecificPlace3 = "";
                var strSpecificPlace4 = "";
                var strSpecificPlace5 = "";
                var strSpecificPlace6 = "";
                var strSpecificPlace7 = "";
                var strSpecificPlace8 = "";
                var strSpecificPlace9 = "";
                var strSpecificPlace10 = "";
                var strSpecificPlace11 = "";
                var strSpecificPlace12 = "";
                var strSpecificPlace13 = "";

                if("true" == OCX.GetObjectInfo("CheckBox_40", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace1 = "颞部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_39", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace2 = "枕部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_35", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace3 = "顶部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_32", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace4 = "眶部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_22", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace5 = "颈部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_38", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace6 = "颌部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_37", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace7 = "牙部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_36", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace8 = "脸部";
                } 
               if("true" == OCX.GetObjectInfo("CheckBox_33", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace9 = "耳部";
                }
                if("true" == OCX.GetObjectInfo("CheckBox_31", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace10 = "眼睑";
                }    
                if("true" == OCX.GetObjectInfo("CheckBox_34", "checked"))
                {
                    strHeadachePlace = "左侧为主";
                    strSpecificPlace11 = "前额";
                }

                //right main
                if("左侧为主" != strHeadachePlace)
                {
                    if("true" == OCX.GetObjectInfo("CheckBox_51", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace1 = "颞部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_49", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace2 = "枕部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_47", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace3 = "顶部";
                    }
                   if("true" == OCX.GetObjectInfo("CheckBox_43", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace4 = "眶部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_41", "checked"))
                   {
                       strHeadachePlace = "右侧为主";
                       strSpecificPlace5 = "颈部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_50", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace6 = "颌部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_48", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace7 = "牙部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_46", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace8 = "脸部";
                    } 
                    if("true" == OCX.GetObjectInfo("CheckBox_44", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace9 = "耳部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_42", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace10 = "眼睑";
                    }    
                    if("true" == OCX.GetObjectInfo("CheckBox_45", "checked"))
                    {
                        strHeadachePlace = "右侧为主";
                        strSpecificPlace11 = "前额";
                    }
                }

                //both main
                if("左侧为主" != strHeadachePlace && "右侧为主" != strHeadachePlace)
                {
                    if("true" == OCX.GetObjectInfo("CheckBox_53", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace1 = "颞部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_54", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace2 = "枕部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_57", "checked"))
                    {
                        strHeadachePlace = "双侧";
                       strSpecificPlace3 = "顶部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_61", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace4 = "眶部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_62", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace5 = "颈部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_52", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace6 = "颌部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_55", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace7 = "牙部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_56", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace8 = "脸部";
                    } 
                    if("true" == OCX.GetObjectInfo("CheckBox_59", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace9 = "耳部";
                    }
                    if("true" == OCX.GetObjectInfo("CheckBox_60", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace10 = "眼睑";
                    }    
                    if("true" == OCX.GetObjectInfo("CheckBox_58", "checked"))
                    {
                        strHeadachePlace = "双侧";
                        strSpecificPlace11 = "前额";
                    }
                }
                if("true" == OCX.GetObjectInfo("CheckBox_QuanHeadache", "checked"))
                    strSpecificPlace12 = "全头痛";
                if("true" == OCX.GetObjectInfo("CheckBox_OtherHeadache", "checked"))
                    strSpecificPlace13 = "其他";


                //Get HeadacheFamilyMember
                var strFuQin = "";
                var strMuQin = "";
                var strXiongDi = "";
                var strJieMei = "";
                var strErZi = "";
                var strNvEr = "";
                var strZuFu = "";
                var strZiMu = "";
                var strWaiZuFu = "";
                var strWaiZuMu = "";
                var strHFamilyMemberQiTa = "";
                if("true" == OCX.GetObjectInfo("CheckBox_21", "checked"))
                    strFuQin = "父亲";
                if("true" == OCX.GetObjectInfo("CheckBox_18", "checked"))
                    strMuQin = "母亲";
                if("true" == OCX.GetObjectInfo("CheckBox_14", "checked"))
                    strXiongDi = "兄弟";
                if("true" == OCX.GetObjectInfo("CheckBox_12", "checked"))
                    strJieMei = "姐妹";
                if("true" == OCX.GetObjectInfo("CheckBox_20", "checked"))
                    strErZi = "儿子";
                if("true" == OCX.GetObjectInfo("CheckBox_17", "checked"))
                    strNvEr = "女儿";
                if("true" == OCX.GetObjectInfo("CheckBox_13", "checked"))
                    strZuFu = "祖父";
                if("true" == OCX.GetObjectInfo("CheckBox_63", "checked"))
                    strZiMu = "祖母";
                if("true" == OCX.GetObjectInfo("CheckBox_19", "checked"))
                    strWaiZuFu = "外祖父";
                if("true" == OCX.GetObjectInfo("CheckBox_16", "checked"))
                    strWaiZuMu = "外祖母";
                if("true" == OCX.GetObjectInfo("CheckBox_15", "checked"))
                    strHFamilyMemberQiTa = "其他";

                //get similar headache
                var strSimilarHeadache = "";
                if("true" == OCX.GetObjectInfo("RadioBox_3", "checked"))
                    strSimilarHeadache = "有";
                else
                    strSimilarHeadache = "无";

                //get OtherFamilyDisease
                var strXinZangJiBin = "";
                var strDianXian = "";
                var strGaoXueYa = "";
                var strZuZhong = "";
                var strGuanJieYan = "";
                var strZhongLiu = "";
                var strJiaoLv = "";
                var strOFamilyDiseaseQiTa = "";
                if("true" == OCX.GetObjectInfo("CheckBox_29", "checked"))
                    strXinZangJiBin = "心脏疾病";
                if("true" == OCX.GetObjectInfo("CheckBox_27", "checked"))
                    strDianXian = "癫痫";
                if("true" == OCX.GetObjectInfo("CheckBox_25", "checked"))
                    strGaoXueYa = "高血压";
                if("true" == OCX.GetObjectInfo("CheckBox_23", "checked"))
                    strZuZhong = "卒中";
                if("true" == OCX.GetObjectInfo("CheckBox_28", "checked"))
                    strGuanJieYan = "关节炎";
                if("true" == OCX.GetObjectInfo("CheckBox_26", "checked"))
                    strZhongLiu = "肿瘤";
                if("true" == OCX.GetObjectInfo("CheckBox_24", "checked"))
                    strJiaoLv = "焦虑";
                if("true" == OCX.GetObjectInfo("CheckBox_30", "checked"))
                    strOFamilyDiseaseQiTa = "其他";

                //get lifestyle
                var strSmokeState = OCX.GetObjectInfo("ComboBox_IfSmoke", "text");
                var strSmokeStartAge = OCX.GetObjectInfo("TextBox_BeginAge", "text");
                var strSmokeQuitYear = OCX.GetObjectInfo("TextBox_QuitYears", "text");
                var strCigarettesPerDay = OCX.GetObjectInfo("TextBox_CigaretteAmount", "text");
                var strSmokeYear = OCX.GetObjectInfo("TextBox_SmokeYears", "text");
                var strDrinkState = OCX.GetObjectInfo("ComboBox_IfDrink", "text");
                var strDrinkStartAge = OCX.GetObjectInfo("TextBox_7", "text");
                var strDrinkYear = OCX.GetObjectInfo("TextBox_DrinkYears", "text");
                var strDrinkQuitYear = OCX.GetObjectInfo("TextBox_QuitDrinkYears", "text");
                var strDrinkPerDay = OCX.GetObjectInfo("TextBox_DrinkCapacityPerDay", "text");
                var strDrinkCategory = OCX.GetObjectInfo("ComboBox_DrinkKind", "text");
                var strTeaPerDay = OCX.GetObjectInfo("TextBox_TeaCapacity", "text");
                var strCoffePerDay = OCX.GetObjectInfo("TextBox_CoffeeCapacity", "text");
                var strExercisePerWeek = OCX.GetObjectInfo("ComboBox_DoSportTimes", "text");
                var strExerciseTime = OCX.GetObjectInfo("ComboBox_DoSportTime", "text");
                var strExerciseDescription = OCX.GetObjectInfo("TextBox_DoSportDescription", "text");
                var strWeightChange = "无";
                if("true" == OCX.GetObjectInfo("RadioBox_WeightChange", "checked"))
                    strWeightChange = "有";
                var strWeightChangeNote = OCX.GetObjectInfo("ComboBox_7", "text");

                var strDiReLiang = "";
                var strDiYan = "";
                var strDiZhi = "";
                var strDiXianWei = "";
                var strDiTanShuiHuaHeWu = "";
                var strGaoReLiang = "";
                var strGaoXianWei = "";
                var strSpecialDietQiTa = "";
                if("true" == OCX.GetObjectInfo("CheckBox_LowHeat", "checked"))
                    strDiReLiang = "低热量";
                if("true" == OCX.GetObjectInfo("CheckBox_LowSalt", "checked"))
                    strDiYan = "低盐";
                if("true" == OCX.GetObjectInfo("CheckBox_LowFat", "checked"))
                    strDiZhi = "低脂";
                if("true" == OCX.GetObjectInfo("CheckBox_LowFibre", "checked"))
                    strDiXianWei = "低纤维";
                if("true" == OCX.GetObjectInfo("CheckBox_LowCarbohydrate", "checked"))
                    strDiTanShuiHuaHeWu = "低碳水化合物";
                if("true" == OCX.GetObjectInfo("CheckBox_HighHeat", "checked"))
                    strGaoReLiang = "高热量";
                if("true" == OCX.GetObjectInfo("CheckBox_HighFibre", "checked"))
                    strGaoXianWei = "高纤维";
                if("true" == OCX.GetObjectInfo("CheckBox_OtherDiet", "checked"))
                    strSpecialDietQiTa = "其他";

                //get PreviousDrug
                var strDrugCategory1 = OCX.GetObjectInfo("ComboBox_DrugCatogry1", "text");
                var strDrugName1 = OCX.GetObjectInfo("TextBox_20", "text");
                var strDayAmoutnPerM1 = OCX.GetObjectInfo("TextBox_Takemedicinedays1", "text");
                var strMonthTotalAmount1 = OCX.GetObjectInfo("TextBox_Takemedicinemonths1", "text");

                var strDrugCategory2 = OCX.GetObjectInfo("ComboBox_DrugCatogry2", "text");
                var strDrugName2 = OCX.GetObjectInfo("TextBox_19", "text");
                var strDayAmoutnPerM2 = OCX.GetObjectInfo("TextBox_Takemedicinedays2", "text");
                var strMonthTotalAmount2 = OCX.GetObjectInfo("TextBox_Takemedicinemonths2", "text");

                var strDrugCategory3 = OCX.GetObjectInfo("ComboBox_DrugCatogry3", "text");
                var strDrugName3 = OCX.GetObjectInfo("TextBox_18", "text");
                var strDayAmoutnPerM3 = OCX.GetObjectInfo("TextBox_Takemedicinedays3", "text");
                var strMonthTotalAmount3 = OCX.GetObjectInfo("TextBox_Takemedicinemonths3", "text");

                var strDrugCategory4 = OCX.GetObjectInfo("ComboBox_DrugCatogry4", "text");
                var strDrugName4 = OCX.GetObjectInfo("TextBox_17", "text");
                var strDayAmoutnPerM4 = OCX.GetObjectInfo("TextBox_Takemedicinedays4", "text");
                var strMonthTotalAmount4 = OCX.GetObjectInfo("TextBox_Takemedicinemonths4", "text");

                //get PreviousExam
                var strExamName1 = OCX.GetObjectInfo("ComboBox_InspectionItem1", "text");
                var strExamResult1 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_InspectionItem1Normal", "checked"))
                    strExamResult1 = "正常";
                var strExamDate1 = OCX.GetObjectInfo("DateTime_InspectionItem1Date", "text");
                if ("/////" == strExamDate1) 
                {
                    strExamDate1 = "1753/01/01///";
                }
                var strExamDate1 = strExamDate1.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName2 = OCX.GetObjectInfo("ComboBox_InspectionItem2", "text");
                var strExamResult2 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_InspectionItem2Normal", "checked"))
                    strExamResult2 = "正常";
                var strExamDate2 = OCX.GetObjectInfo("DateTime_InspectionItem2Date", "text");
                if ("/////" == strExamDate2) 
                {
                    strExamDate2 = "1753/01/01///";
                }
                var strExamDate2 = strExamDate2.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName3 = OCX.GetObjectInfo("ComboBox_InspectionItem3", "text");
                var strExamResult3 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_InspectionItem3Normal", "checked"))
                    strExamResult3 = "正常";
                var strExamDate3 = OCX.GetObjectInfo("DateTime_InspectionItem3Date", "text");
                if ("/////" == strExamDate3) 
                {
                    strExamDate3 = "1753/01/01///";
                }
                var strExamDate3 = strExamDate3.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName4 = OCX.GetObjectInfo("ComboBox_InspectionItem4", "text");
                var strExamResult4 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_InspectionItem4Normal", "checked"))
                    strExamResult4 = "正常";
                var strExamDate4 = OCX.GetObjectInfo("DateTime_InspectionItem4Date", "text");
                if ("/////" == strExamDate4) 
                {
                    strExamDate4 = "1753/01/01///";
                }
                var strExamDate4 = strExamDate4.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                var strExamName5 = OCX.GetObjectInfo("ComboBox_InspectionItem5", "text");
                var strExamResult5 = "异常";
                if("true" == OCX.GetObjectInfo("RadioBox_InspectionItem5Normal", "checked"))
                    strExamResult5 = "正常";
                var strExamDate5 = OCX.GetObjectInfo("DateTime_InspectionItem5Date", "text");
                if ("/////" == strExamDate5) 
                {
                    strExamDate5 = "1753/01/01///";
                }
                var strExamDate5 = strExamDate5.slice(0, 10).replace("/", "-").replace("/", "-") + " 00:00:00";

                //get headache accompany
                var strHeadacheAccompanySymptom1 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Exin", "checked"))
                    strHeadacheAccompanySymptom1 = "恶心";

                var strHeadacheAccompanySymptom2 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Otu", "checked"))
                    strHeadacheAccompanySymptom2 = "呕吐";

                var strHeadacheAccompanySymptom3 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Weiguang", "checked"))
                    strHeadacheAccompanySymptom3 = "畏光";

                var strHeadacheAccompanySymptom4 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Pachao", "checked"))
                    strHeadacheAccompanySymptom4 = "怕吵";

                var strHeadacheAccompanySymptom5 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongcebisai", "checked"))
                    strHeadacheAccompanySymptom5 = "同侧鼻塞/流涕";

                var strHeadacheAccompanySymptom6 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongcejiemochongxue", "checked"))
                    strHeadacheAccompanySymptom6 = "同侧结膜充血/流泪";

                var strHeadacheAccompanySymptom7 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongceqianechuhan", "checked"))
                    strHeadacheAccompanySymptom7 = "同侧前额/面部出汗";

                var strHeadacheAccompanySymptom8 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongceyanjianshuizhong", "checked"))
                    strHeadacheAccompanySymptom8 = "同侧眼睑水肿";

                var strHeadacheAccompanySymptom9 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongceyanjianxiachui", "checked"))
                    strHeadacheAccompanySymptom9 = "同侧眼睑下垂";

                var strHeadacheAccompanySymptom10 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Tongcetongkongsuoxiao", "checked"))
                    strHeadacheAccompanySymptom10 = "同侧瞳孔缩小";

                var strHeadacheAccompanySymptom11 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_Ganjuebuan", "checked"))
                    strHeadacheAccompanySymptom11 = "感觉不安或躁动";

                var strHeadacheAccompanySymptom12 = "";
                if("true" == OCX.GetObjectInfo("CheckBox_OtherCompanySympton", "checked"))
                    strHeadacheAccompanySymptom12 = "其它";

                //get Mitigating information
                var strMitigatingFactor1 = "";
                var strMitigatingFactor2 = "";
                var strMitigatingFactor3 = "";
                var strMitigatingFactor4 = "";
                var strMitigatingFactor5 = "";
                var strMitigatingFactor6 = "";
                var strMitigatingFactor7 = "";
                var strMitigatingFactor8 = "";
                var strMitigatingFactor9 = "";
                var strMitigatingFactor10 = "";
                if("有" == OCX.GetObjectInfo("ComboBox_20", "text"))
                    strMitigatingFactor1 = "躺下";
                if("有" == OCX.GetObjectInfo("ComboBox_21", "text"))
                    strMitigatingFactor2 = "黑暗/安静的房间";
                if("有" == OCX.GetObjectInfo("ComboBox_22", "text"))
                    strMitigatingFactor3 = "按摩";
                if("有" == OCX.GetObjectInfo("ComboBox_23", "text"))
                    strMitigatingFactor4 = "热敷";
                if("有" == OCX.GetObjectInfo("ComboBox_26", "text"))
                    strMitigatingFactor5 = "冷敷";
                if("有" == OCX.GetObjectInfo("ComboBox_11", "text"))
                    strMitigatingFactor6 = "快步走";
                if("有" == OCX.GetObjectInfo("ComboBox_12", "text"))
                    strMitigatingFactor7 = "锻炼";
                if("有" == OCX.GetObjectInfo("ComboBox_13", "text"))
                    strMitigatingFactor8 = "站立";
                if("有" == OCX.GetObjectInfo("ComboBox_17", "text"))
                    strMitigatingFactor9 = "妊娠";
                if("有" == OCX.GetObjectInfo("ComboBox_18", "text"))
                    strMitigatingFactor10 = "其他";

                //get Precipitating Factor
                var strPrecipitatingFactor1 = "";
                var strPrecipitatingFactor2 = "";
                var strPrecipitatingFactor3 = "";
                var strPrecipitatingFactor4 = "";
                var strPrecipitatingFactor5 = "";
                var strPrecipitatingFactor6 = "";
                var strPrecipitatingFactor7 = "";
                var strPrecipitatingFactor8 = "";
                var strPrecipitatingFactor9 = "";
                var strPrecipitatingFactor10 = "";
                var strPrecipitatingFactorDetail1 = OCX.GetObjectInfo("ComboBox_30", "text");
                var strPrecipitatingFactorDetail2 = OCX.GetObjectInfo("ComboBox_29", "text");
                var strPrecipitatingFactorDetail3 = OCX.GetObjectInfo("ComboBox_28", "text");
                var strPrecipitatingFactorDetail4 = OCX.GetObjectInfo("ComboBox_27", "text");
                var strPrecipitatingFactorDetail5 = OCX.GetObjectInfo("ComboBox_25", "text");
                var strPrecipitatingFactorDetail6 = OCX.GetObjectInfo("ComboBox_14", "text");
                var strPrecipitatingFactorDetail7 = OCX.GetObjectInfo("ComboBox_15", "text");
                var strPrecipitatingFactorDetail8 = OCX.GetObjectInfo("ComboBox_16", "text");
                var strPrecipitatingFactorDetail9 = OCX.GetObjectInfo("ComboBox_19", "text");
                var strPrecipitatingFactorDetail10 = OCX.GetObjectInfo("ComboBox_24", "text");
                if("" != strPrecipitatingFactorDetail1)
                {
                    strPrecipitatingFactor1 = "睡眠";
                }
                if("" != strPrecipitatingFactorDetail2)
                {
                    strPrecipitatingFactor2 = "感觉刺激";
                }
                if("有" == strPrecipitatingFactorDetail3)
                {
                    strPrecipitatingFactorDetail3 = "";
                    strPrecipitatingFactor3 = "紧张/情绪波动";
                }
                if("" != strPrecipitatingFactorDetail4)
                {
                    strPrecipitatingFactor4 = "食物";
                }
                if("" != strPrecipitatingFactorDetail5)
                {
                    strPrecipitatingFactor5 = "活动";
                }
                if("" != strPrecipitatingFactorDetail6)
                {
                    strPrecipitatingFactor6 = "气候";
                }
                if("有" == strPrecipitatingFactorDetail7)
                {
                    strPrecipitatingFactorDetail7 = "";
                    strPrecipitatingFactor7 = "疲劳/放松";
                }
                if("" != strPrecipitatingFactorDetail8)
                {
                    strPrecipitatingFactor8 = "激素变化";
                }
                if("" != strPrecipitatingFactorDetail9)
                {
                    strPrecipitatingFactor9 = "体位";
                }
                if("有" == strPrecipitatingFactorDetail10)
                {
                    strPrecipitatingFactorDetail10 = "";
                    strPrecipitatingFactor10 = "其他";
                }

                //HeadacheProdrome
                var strHeadacheProdrome1 = "";
                var strHeadacheProdrome2 = "";
                var strHeadacheProdrome3 = "";
                var strHeadacheProdrome4 = "";
                if("true" == OCX.GetObjectInfo("RadioBox_VisionYes", "checked"))
                    strHeadacheProdrome1 = "视觉（点状/色斑/线型闪光幻觉/视野缺损）";
                if("true" == OCX.GetObjectInfo("RadioBox_FeelingYes", "checked"))
                    strHeadacheProdrome2 = "感觉（针刺感/麻木）";
                if("true" == OCX.GetObjectInfo("RadioBox_WordYes", "checked"))
                    strHeadacheProdrome3 = "语言障碍";
                if("true" == OCX.GetObjectInfo("RadioBox_2", "checked"))
                    strHeadacheProdrome4 = "运动障碍";

                //get visit record
                var strChiefComplaint = OCX.GetObjectInfo("TextBox_12", "text");
                var strCDSSDiagnosis1 = OCX.GetObjectInfo("TextBox_14", "text");
                var strCDSSDiagnosis2 = OCX.GetObjectInfo("TextBox_15", "text");
                var strCDSSDiagnosis3 = OCX.GetObjectInfo("TextBox_16", "text");
                var strDiagnosisResult1 = OCX.GetObjectInfo("ComboBox_32", "text");
                var strDiagnosisResult2 = OCX.GetObjectInfo("ComboBox_34", "text");
                var strDiagnosisResult3 = OCX.GetObjectInfo("ComboBox_35", "text");

                //prescription
                var strPrescription = "";

                var thing = { Similarfamily : strSimilarHeadache,
                              HFamilyMember: [ { Person: strFuQin}, { Person: strMuQin}, { Person: strXiongDi}
                                            , { Person: strJieMei}, { Person: strErZi}, { Person: strNvEr}
                                            , { Person: strZuFu}, { Person: strZiMu}, { Person: strWaiZuFu}
                                            , { Person: strWaiZuMu}, { Person: strHFamilyMemberQiTa} ],
                              OFamilyDisease: [ {DiseaseName: strXinZangJiBin}, {DiseaseName: strDianXian}, {DiseaseName: strGaoXueYa}
                                            , {DiseaseName: strZuZhong}, {DiseaseName: strGuanJieYan}, {DiseaseName: strZhongLiu}
                                            , {DiseaseName: strJiaoLv}, {DiseaseName: strOFamilyDiseaseQiTa} ],
                              lifestyle: {SmokeState: strSmokeState, SmokeStartAge: strSmokeStartAge, SmokeQuitYear:strSmokeQuitYear
                                            , SmokeYear: strSmokeYear, CigarettesPerDay: strCigarettesPerDay, DrinkState:strDrinkState
                                            , DrinkStartAge: strDrinkStartAge, DrinkYear: strDrinkYear, DrinkQuitYear:strDrinkQuitYear
                                            , DrinkPerDay: strDrinkPerDay, DrinkCategory: strDrinkCategory, TeaPerDay:strTeaPerDay
                                            , CoffePerDay: strCoffePerDay, ExercisePerWeek: strExercisePerWeek, ExerciseTime:strExerciseTime
                                            , ExerciseDescription: strExerciseDescription, WeightChange: strWeightChange, WeightChangeNote:strWeightChangeNote
                                            , SpecialDiet:[{Kind:strDiReLiang}, {Kind:strDiYan}, {Kind:strDiZhi}, {Kind:strDiXianWei}
                                                            , {Kind:strDiTanShuiHuaHeWu}, {Kind:strGaoReLiang}, {Kind:strGaoXianWei}, {Kind:strSpecialDietQiTa}]},
                              PDrug: [{DrugCategory: strDrugCategory1, DrugName: strDrugName1, DayAmoutnPerM: strDayAmoutnPerM1, MonthTotalAmount: strMonthTotalAmount1}
                                        ,{DrugCategory: strDrugCategory2, DrugName: strDrugName2, DayAmoutnPerM: strDayAmoutnPerM2, MonthTotalAmount: strMonthTotalAmount2}
                                        ,{DrugCategory: strDrugCategory3, DrugName: strDrugName3, DayAmoutnPerM: strDayAmoutnPerM3, MonthTotalAmount: strMonthTotalAmount3}
                                        ,{DrugCategory: strDrugCategory4, DrugName: strDrugName4, DayAmoutnPerM: strDayAmoutnPerM4, MonthTotalAmount: strMonthTotalAmount4} ],
                              PExam: [{ExamName: strExamName1, Result:strExamResult1, Date:strExamDate1}
                                        ,{ExamName: strExamName2, Result:strExamResult2, Date:strExamDate2}
                                        ,{ExamName: strExamName3, Result:strExamResult3, Date:strExamDate3}
                                        ,{ExamName: strExamName4, Result:strExamResult4, Date:strExamDate4}
                                        ,{ExamName: strExamName5, Result:strExamResult5, Date:strExamDate5}],
                              PHeadacheOverview: {HeadacheType: strHeadacheType, HeadacheDegree: strHeadacheDegree, HeadcheTime: strHeadcheTime
                                                    , HeacheTimeUnit: strHeacheTimeUnit, FrequencyPerDay: strFrequencyPerDay, FrequencyPerMonth: strFrequencyPerMonth
                                                    , OnsetFixedDay: strOnsetFixedDay, OnsetFixedYear: strOnsetFixedYear, OnsetDate: strOnsetDate
                                                    , OnsetAmount: strOnsetAmount, DailyAggravation: strDailyAggravation, FirstOnsetContinue: strFirstOnsetContinue
                                                    , HeadachePlace:[{Position: strHeadachePlace, SpecificPlace: strSpecificPlace1}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace2}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace1}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace2}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace3}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace4}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace5}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace6}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace7}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace8}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace9}, {Position: strHeadachePlace, SpecificPlace: strSpecificPlace10}
                                                                        , {Position: strHeadachePlace, SpecificPlace: strSpecificPlace11}, {Position: "", SpecificPlace: strSpecificPlace12}
                                                                        , {Position: "", SpecificPlace: strSpecificPlace13}]
                                                    , HeadacheAccompany: [{Symptom: strHeadacheAccompanySymptom1},{Symptom: strHeadacheAccompanySymptom2}
                                                                            , {Symptom: strHeadacheAccompanySymptom3},{Symptom: strHeadacheAccompanySymptom4}
                                                                            , {Symptom: strHeadacheAccompanySymptom5},{Symptom: strHeadacheAccompanySymptom6}
                                                                            , {Symptom: strHeadacheAccompanySymptom7},{Symptom: strHeadacheAccompanySymptom8}
                                                                            , {Symptom: strHeadacheAccompanySymptom9},{Symptom: strHeadacheAccompanySymptom10}
                                                                            , {Symptom: strHeadacheAccompanySymptom11},{Symptom: strHeadacheAccompanySymptom12}]
                                                    , MitigatingFactors: [ {FactorName: strMitigatingFactor1}, {FactorName: strMitigatingFactor2}, {FactorName: strMitigatingFactor3}
                                                                            , {FactorName: strMitigatingFactor4}, {FactorName: strMitigatingFactor5}, {FactorName: strMitigatingFactor6}
                                                                            , {FactorName: strMitigatingFactor7}, {FactorName: strMitigatingFactor8}, {FactorName: strMitigatingFactor9}
                                                                            , {FactorName: strMitigatingFactor10} ]
                                                    , PrecipitatingFactor: [ {FactorName: strPrecipitatingFactor1, FactorDetail: strPrecipitatingFactorDetail1}, {FactorName: strPrecipitatingFactor2, FactorDetail: strPrecipitatingFactorDetail2}, {FactorName: strPrecipitatingFactor3, FactorDetail: strPrecipitatingFactorDetail3}
                                                                            , {FactorName: strPrecipitatingFactor4, FactorDetail: strPrecipitatingFactorDetail4}, {FactorName: strPrecipitatingFactor5, FactorDetail: strPrecipitatingFactorDetail5}, {FactorName: strPrecipitatingFactor6, FactorDetail: strPrecipitatingFactorDetail6}
                                                                            , {FactorName: strPrecipitatingFactor7, FactorDetail: strPrecipitatingFactorDetail7}, {FactorName: strPrecipitatingFactor8, FactorDetail: strPrecipitatingFactorDetail8}, {FactorName: strPrecipitatingFactor9, FactorDetail: strPrecipitatingFactorDetail9}
                                                                            , {FactorName: strPrecipitatingFactor10, FactorDetail: strPrecipitatingFactorDetail10} ]
                                                    , HeadacheProdrome: [ {Prodrome: strHeadacheProdrome1}, {Prodrome: strHeadacheProdrome2}, {Prodrome: strHeadacheProdrome3}, {Prodrome: strHeadacheProdrome4} ]},
                              visitrecord: {ChiefComplaint: strChiefComplaint
                                                    ,CDSSDiagnosis1: strCDSSDiagnosis1, CDSSDiagnosis2: strCDSSDiagnosis2, CDSSDiagnosis3: strCDSSDiagnosis3
                                                    ,DiagnosisResult1: strDiagnosisResult1, DiagnosisResult2: strDiagnosisResult2, DiagnosisResult3: strDiagnosisResult3
                                                    ,Prescription: strPrescription
                                                    ,SecondaryHeadacheSymptom:[{Symptom: strSecondaryHeadacheSymptom1}, {Symptom: strSecondaryHeadacheSymptom2}, {Symptom: strSecondaryHeadacheSymptom3}
                                                                                , {Symptom: strSecondaryHeadacheSymptom4}, {Symptom: strSecondaryHeadacheSymptom5}, {Symptom: strSecondaryHeadacheSymptom6}
                                                                                , {Symptom: strSecondaryHeadacheSymptom7}, {Symptom: strSecondaryHeadacheSymptom8}, {Symptom: strSecondaryHeadacheSymptom9}
                                                                                , {Symptom: strSecondaryHeadacheSymptom10}]}

                                             };
               var encoded = $.toJSON(thing);
                }
                if($(".selected").last().attr("id") == "报告")
                {

                    $("#ocx").hide();
                    $(".active").wBox({title: "提示信息", html: "<div class='demo'><img src='../../Content/images/wait.gif'/></div>", show: true  });
                    $.ajax({
                        url: '@Url.Action("Save", "Diagnosis")',
                        type: "POST",
                        data: { postjson: encoded },
                        success: function (data) {
                            if (data.OK) {
                             var OCX = document.getElementById('Reporter2');
                            OCX.EnableMacroPrint(true);
                            OCX.PrintPages("报告", false);
                              $(".demo").html("本次问诊信息保存成功！");
                                var t = setTimeout("  window.location.href = '@Url.Action("Index", "EnterPatInfor")'", 6000);
                            }
                            else {
                                document.getElementById("msg").innerHTML = data.Message.toString();
                            }

                        },
                        error: function (jqXhr, textStatus, errorThrown) {
                            alert("Error '" + jqXhr.status + "' (textStatus: '" + textStatus + "', errorThrown: '" + errorThrown + "')");
                        }
                    });
            }
                         else
                         {
                               
                               if($(".selected").last().attr("id")!="头痛问诊")
                       {  
                            $(".selected").next().addClass("selected");
                            var name = $(".selected").last().attr("id");
                            $(".active").next().addClass("active");
                            $(".active").first().removeClass("active");
                            OCX.SetData("Data_source/VisitRecord/CDSSDiagnosis", "        " + "正在推理中。。。");
                            OCX.ShowReport();
                            OCX.ShowThisPage(name);
                            if(name=="报告"){
                             $("#b1").html("保存并打印");
                             }
                         }
                         else
                         {

                                    $.ajax({
                                        url: '@Url.Action("CDSSdiagnosis", "Diagnosis")',
                                        type: "POST",
                                        data: { postjson: encoded },
                                        success: function (data) {
                                            if (data.OK) {
                                                OCX.SetData("Data_source/VisitRecord/CDSSDiagnosis", "        " + data.Message);
                                                   $(".selected").next().addClass("selected");
                                                   var name = $(".selected").last().attr("id");
                                                   $(".active").next().addClass("active");
                                                    $(".active").first().removeClass("active");
                                                 // OCX.SetData("Data_source/VisitRecord/CDSSDiagnosis", "        " + "正在推理中。。。");
                                                   OCX.ShowReport();
                                                  OCX.ShowThisPage(name);
                                            }
                                            else {
                                                alert(data.Message.toString());

                                            }

                                        },
                                        error: function (jqXhr, textStatus, errorThrown) {
                                            alert("Error '" + jqXhr.status + "' (textStatus: '" + textStatus + "', errorThrown: '" + errorThrown + "')");
                                        }
                                    });
                               
                            
                         }
                  
                 }
                

        
     });
    });
</script>
